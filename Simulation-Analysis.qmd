---
title: "Simulation-Analysis"
author: "Visruth Srimath Kandali"
format: html
---

## Set Up

```{r}
#| label: setup
library(ggplot2)
set.seed(2626)
# TODO: change back to 100k
r <- 10000 # number of repetitions
# sample_sizes <- c(5, 10, 20, 30, 40, 100, 200, 300, 400, 1000, 2000, 3000, 4000)
sample_sizes <- c(5, 10, 20)
```

We are opting to create 100,000 samples (repetitions) to create the sampling distribution so as to mitigate any concerns of random variability influencing our conclusions.

```{r}
analysis <- function(statistic, distro, ...) {
  statistic(distro(...))

  # # TODO distro not accepting the "..." parameters
  # sample_means <- replicate(r, statistic(distro(...)))
  # # hist(distro(n, ...), main = paste("Example Sample Distribution, n = ", n))
  # # hist(sample_means, main = "Sampling Distribution")
  # # qqnorm(sample_means)
  # # qqline(sample_means)
  # moments::skewness(sample_means)
}
```
An extensible function that generates sampling distributions given a population function to sample from, inferred parameters for that population, and a sampling distribution to plot and calculate skewness of.

```{r}
set.seed(0)
e <- mean(rlnorm(20, 10, 0.25))
set.seed(0)
a <- analysis(mean, rlnorm, n = 20, meanlog = 10, sdlog = 0.25)

print(e)
print(a)
identical(e, a)
```


```{r}
set.seed(0)
moments::skewness(replicate(r, mean(rlnorm(20, 0, 0.25))))
set.seed(0)
analysis(mean, rlnorm, n = 20, meanlog = 0, sdlog = 0.25)
```


```{r}
sapply(sample_sizes, analysis, statistic = mean, distro = rlnorm, meanlog = 0, sdlog = 1)
sapply(sample_sizes, analysis, statistic = mean, distro = rlnorm, meanlog = 0, sdlog = 0.5)
sapply(sample_sizes, analysis, statistic = mean, distro = rlnorm, meanlog = 0, sdlog = 0.25)
sapply(sample_sizes, analysis, statistic = mean, distro = rnorm)
```

Distributions:

-   Just use Pearson?

-   Use log normal and adjust sigma for skewness level?

-   Exponential

-   Normal

-   Chi Square

-   Uniform
